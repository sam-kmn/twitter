"use client"
import Header from "@/components/Header"
import useSWR from "swr"
import { useState } from "react"
import Tweet from "@/components/Tweet"

// export const metadata = {
//   title: "Explore",
//   description: "Generated by create next app",
// }

function Tweets({ index }: { index: number }) {
  const { data } = useSWR(`/api/tweets/explore?page=${index}`, (...args) =>
    fetch(...args).then((res) => res.json())
  )

  // ... handle loading and error states
  console.log(data)
  if (!data) return <div>No tweets</div>
  return data.tweets.map((tweet: any) => <Tweet key={tweet.id} tweet={tweet} />)
}

export default function Page() {
  const [page, setPage] = useState(1)

  const pages = []
  for (let i = 0; i < page; i++) {
    pages.push(<Tweets index={i} key={i} />)
  }

  return (
    <>
      <Header title={"explore"} />
      {pages}
      <button onClick={() => setPage(page + 1)}>Load more</button>
    </>
  )
}
